import{l as q,S as B,T as F,r as w,J as V,q as _,A as Q,u as U,y as z,N as x,L as H,g as J,z as K}from"./BHZ1H3K9.js";function $(t){return Q()?(U(t),!0):!1}function b(t){return typeof t=="function"?t():z(t)}const y=typeof window<"u"&&typeof document<"u",X=typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope,Y=Object.prototype.toString,Z=t=>Y.call(t)==="[object Object]",k=()=>{};function ee(t,n){var r;if(typeof t=="number")return t+n;const i=((r=t.match(/^-?[0-9]+\.?[0-9]*/))==null?void 0:r[0])||"",a=t.slice(i.length),o=Number.parseFloat(i)+n;return Number.isNaN(o)?t:o+a}function te(...t){if(t.length!==1)return q(...t);const n=t[0];return typeof n=="function"?B(F(()=>({get:n,set:k}))):w(n)}function ne(t,n=1e3,r={}){const{immediate:i=!0,immediateCallback:a=!1}=r;let o=null;const s=w(!1);function m(){o&&(clearInterval(o),o=null)}function v(){s.value=!1,m()}function c(){const e=b(n);e<=0||(s.value=!0,a&&t(),m(),o=setInterval(t,e))}if(i&&y&&c(),V(n)||typeof n=="function"){const e=_(n,()=>{s.value&&y&&c()});$(e)}return $(v),{isActive:s,pause:v,resume:c}}function re(t){var n;const r=b(t);return(n=r==null?void 0:r.$el)!=null?n:r}const R=y?window:void 0;function ue(...t){let n,r,i,a;if(typeof t[0]=="string"||Array.isArray(t[0])?([r,i,a]=t,n=R):[n,r,i,a]=t,!n)return k;Array.isArray(r)||(r=[r]),Array.isArray(i)||(i=[i]);const o=[],s=()=>{o.forEach(e=>e()),o.length=0},m=(e,u,f,p)=>(e.addEventListener(u,f,p),()=>e.removeEventListener(u,f,p)),v=_(()=>[re(n),b(a)],([e,u])=>{if(s(),!e)return;const f=Z(u)?{...u}:u;o.push(...r.flatMap(p=>i.map(E=>m(e,p,E,f))))},{immediate:!0,flush:"post"}),c=()=>{v(),s()};return $(c),c}function oe(){const t=w(!1),n=K();return n&&J(()=>{t.value=!0},n),t}function ae(t){const n=oe();return x(()=>(n.value,!!t()))}function S(t,n={}){const{window:r=R}=n,i=ae(()=>r&&"matchMedia"in r&&typeof r.matchMedia=="function");let a;const o=w(!1),s=c=>{o.value=c.matches},m=()=>{a&&("removeEventListener"in a?a.removeEventListener("change",s):a.removeListener(s))},v=H(()=>{i.value&&(m(),a=r.matchMedia(b(t)),"addEventListener"in a?a.addEventListener("change",s):a.addListener(s),o.value=a.matches)});return $(()=>{v(),m(),a=void 0}),o}function se(t,n={}){function r(e,u){let f=b(t[b(e)]);return u!=null&&(f=ee(f,u)),typeof f=="number"&&(f=`${f}px`),f}const{window:i=R,strategy:a="min-width"}=n;function o(e){return i?i.matchMedia(e).matches:!1}const s=e=>S(()=>`(min-width: ${r(e)})`,n),m=e=>S(()=>`(max-width: ${r(e)})`,n),v=Object.keys(t).reduce((e,u)=>(Object.defineProperty(e,u,{get:()=>a==="min-width"?s(u):m(u),enumerable:!0,configurable:!0}),e),{});function c(){const e=Object.keys(t).map(u=>[u,s(u)]);return x(()=>e.filter(([,u])=>u.value).map(([u])=>u))}return Object.assign(v,{greaterOrEqual:s,smallerOrEqual:m,greater(e){return S(()=>`(min-width: ${r(e,.1)})`,n)},smaller(e){return S(()=>`(max-width: ${r(e,-.1)})`,n)},between(e,u){return S(()=>`(min-width: ${r(e)}) and (max-width: ${r(u,-.1)})`,n)},isGreater(e){return o(`(min-width: ${r(e,.1)})`)},isGreaterOrEqual(e){return o(`(min-width: ${r(e)})`)},isSmaller(e){return o(`(max-width: ${r(e,-.1)})`)},isSmallerOrEqual(e){return o(`(max-width: ${r(e)})`)},isInBetween(e,u){return o(`(min-width: ${r(e)}) and (max-width: ${r(u,-.1)})`)},current:c,active(){const e=c();return x(()=>e.value.length===0?"":e.value.at(-1))}})}const P="ping";function T(t){return t===!0?{}:t}function le(t,n={}){const{onConnected:r,onDisconnected:i,onError:a,onMessage:o,immediate:s=!0,autoClose:m=!0,protocols:v=[]}=n,c=w(null),e=w("CLOSED"),u=w(),f=te(t);let p,E,g=!1,W=0,L=[],M;const j=()=>{if(L.length&&u.value&&e.value==="OPEN"){for(const l of L)u.value.send(l);L=[]}},D=()=>{clearTimeout(M),M=void 0},O=(l=1e3,d)=>{!y||!u.value||(g=!0,D(),p==null||p(),u.value.close(l,d),u.value=void 0)},G=(l,d=!0)=>!u.value||e.value!=="OPEN"?(d&&L.push(l),!1):(j(),u.value.send(l),!0),A=()=>{if(g||typeof f.value>"u")return;const l=new WebSocket(f.value,v);u.value=l,e.value="CONNECTING",l.onopen=()=>{e.value="OPEN",r==null||r(l),E==null||E(),j()},l.onclose=d=>{if(e.value="CLOSED",i==null||i(l,d),!g&&n.autoReconnect){const{retries:h=-1,delay:N=1e3,onFailed:C}=T(n.autoReconnect);W+=1,typeof h=="number"&&(h<0||W<h)||typeof h=="function"&&h()?setTimeout(A,N):C==null||C()}},l.onerror=d=>{a==null||a(l,d)},l.onmessage=d=>{if(n.heartbeat){D();const{message:h=P}=T(n.heartbeat);if(d.data===h)return}c.value=d.data,o==null||o(l,d)}};if(n.heartbeat){const{message:l=P,interval:d=1e3,pongTimeout:h=1e3}=T(n.heartbeat),{pause:N,resume:C}=ne(()=>{G(l,!1),M==null&&(M=setTimeout(()=>{O(),g=!1},h))},d,{immediate:!1});p=N,E=C}m&&(y&&ue("beforeunload",()=>O()),$(O));const I=()=>{!y&&!X||(O(),g=!1,W=0,A())};return s&&I(),{data:c,status:e,close:O,send:G,open:I,ws:u}}export{le as a,se as u};
